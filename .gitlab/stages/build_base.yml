variables:
  BASE_IMAGE_REPO: ${CI_REGISTRY_IMAGE}/ci-image-base
  BASE_DOCKER_DIR: docker/base

build_image_base:
  stage: build_base
  before_script:
    - echo "${CI_REGISTRY_PASSWORD}" | docker login -u ${CI_REGISTRY_USER} --password-std-in ${CI_REGISTRY}
  script:
    - docker pull ${BASE_IMAGE_REPO}:latest || true
    - docker build --pull -f ${BASE_DOCKER_DIR}/Dockerfile -t ${BASE_IMAGE_REPO}:latest ${BASE_DOCKER_DIR}
    - docker push ${BASE_IMAGE_REPO}:latest
  tags:
    - ${TAGS}
